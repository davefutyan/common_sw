<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Common Software: BarycentricOffset Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cheops-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Common Software
   &#160;<span id="projectnumber">05</span>
   </div>
   <div id="projectbrief">Common Software for CHEOPS SOC - C++ API</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="class_barycentric_offset-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">BarycentricOffset Class Reference<div class="ingroups"><a class="el" href="group__utilities.html">Utility classes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A class to calculate the time difference of <a class="el" href="class_b_j_d.html" title="A class to store a Barycentric Julian Day (BJD) ">BJD</a> - <a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a>.  
 <a href="class_barycentric_offset.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_barycentric_offset_8hxx_source.html">BarycentricOffset.hxx</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2ece112267747a07f63693e6af49e97c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a2ece112267747a07f63693e6af49e97c">BarycentricOffset</a> (double ra, double dec)</td></tr>
<tr class="memdesc:a2ece112267747a07f63693e6af49e97c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The class is initialized for a specific source, i.e. with its sky position RA / DEC.  <a href="#a2ece112267747a07f63693e6af49e97c">More...</a><br /></td></tr>
<tr class="separator:a2ece112267747a07f63693e6af49e97c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7a0d7179b3d5e35475844edb854f07f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#af7a0d7179b3d5e35475844edb854f07f">BarycentricOffset</a> (const <a class="el" href="class_barycentric_offset.html">BarycentricOffset</a> &amp;barycentricOffset)</td></tr>
<tr class="memdesc:af7a0d7179b3d5e35475844edb854f07f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy constructor of the <a class="el" href="class_barycentric_offset.html" title="A class to calculate the time difference of BJD - MJD. ">BarycentricOffset</a> class.  <a href="#af7a0d7179b3d5e35475844edb854f07f">More...</a><br /></td></tr>
<tr class="separator:af7a0d7179b3d5e35475844edb854f07f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcf77584a92a19de51975a5be479b997"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#adcf77584a92a19de51975a5be479b997">Offset</a> (double mjd)</td></tr>
<tr class="memdesc:adcf77584a92a19de51975a5be479b997"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to calculate the time offset between <a class="el" href="class_b_j_d.html" title="A class to store a Barycentric Julian Day (BJD) ">BJD</a> and <a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a>.  <a href="#adcf77584a92a19de51975a5be479b997">More...</a><br /></td></tr>
<tr class="separator:adcf77584a92a19de51975a5be479b997"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ae5670eafc5031a09af5ddc893d29d4ff"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#ae5670eafc5031a09af5ddc893d29d4ff">setEphemerisFileName</a> (const std::string fileName)</td></tr>
<tr class="memdesc:ae5670eafc5031a09af5ddc893d29d4ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the file containing the ephemeris data in a EXT_APP_DE1 data structure. It is called by the <a class="el" href="group___prog_param.html#gac588050f01e813c2a25336cb967f20b5" title="Initializes various infrastructure modules using the program arguments. ">CheopsInit()</a> function.  <a href="#ae5670eafc5031a09af5ddc893d29d4ff">More...</a><br /></td></tr>
<tr class="separator:ae5670eafc5031a09af5ddc893d29d4ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a518900fa18a9fa0ced0ec2826da9739c"><td class="memItemLeft" align="right" valign="top"><a id="a518900fa18a9fa0ced0ec2826da9739c"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>BODY</b> { <b>BARY_EARTH_MOON</b>, 
<b>BARY_MOON</b>, 
<b>BARY_SUN</b>
 }</td></tr>
<tr class="separator:a518900fa18a9fa0ced0ec2826da9739c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a903f8e8dcc5b9990b5ce431c9733b29f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a903f8e8dcc5b9990b5ce431c9733b29f">calcVector</a> ()</td></tr>
<tr class="memdesc:a903f8e8dcc5b9990b5ce431c9733b29f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms a RA and Dec orientation in degrees into a unit vector in J2000 ECI coordinates.  <a href="#a903f8e8dcc5b9990b5ce431c9733b29f">More...</a><br /></td></tr>
<tr class="separator:a903f8e8dcc5b9990b5ce431c9733b29f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7294888de9431ae01986afd76815a15e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a7294888de9431ae01986afd76815a15e">initBarycent</a> ()</td></tr>
<tr class="memdesc:a7294888de9431ae01986afd76815a15e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read physical constants from the ephemiris file and initialize some variables.  <a href="#a7294888de9431ae01986afd76815a15e">More...</a><br /></td></tr>
<tr class="separator:a7294888de9431ae01986afd76815a15e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a9bb8d30418b612da0ed1acae6a20c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a00a9bb8d30418b612da0ed1acae6a20c">getBaryVectors</a> (double tt_ijd, double SolSysBaryCenter_to_Spacecraft[3], double Sun_to_Spacecraft[3], double EarthVelocity[3])</td></tr>
<tr class="memdesc:a00a9bb8d30418b612da0ed1acae6a20c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the various vectors needed for the barycentric correction at the given input time, which is expected to be IJD.  <a href="#a00a9bb8d30418b612da0ed1acae6a20c">More...</a><br /></td></tr>
<tr class="separator:a00a9bb8d30418b612da0ed1acae6a20c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259da5dd022565a9f0f84e89f47d501f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a259da5dd022565a9f0f84e89f47d501f">getDE200</a> (BODY body, double ttime, double pos[3], double vel[3])</td></tr>
<tr class="memdesc:a259da5dd022565a9f0f84e89f47d501f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reads the ISDC DE200 ephemeris. Bodies are restricted to Earth-Moon barycenter (SSB), Moon (Geocentric) and Sun (SSB). Returns position and velocities in 3-vectors if pointer!=NULL.  <a href="#a259da5dd022565a9f0f84e89f47d501f">More...</a><br /></td></tr>
<tr class="separator:a259da5dd022565a9f0f84e89f47d501f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c7eed4027ed8009c41013d329974dd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a84c7eed4027ed8009c41013d329974dd">TimeConvert_BaryCenter_Correction</a> (double tt_mjd, double SolSysBaryCenter_to_Spacecraft[3], double Sun_to_Spacecraft[3], double EarthVelocity[3], double SolarMass) const</td></tr>
<tr class="memdesc:a84c7eed4027ed8009c41013d329974dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the shift in seconds between an observed time in <a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a> and the time of measurement at the solar system barycenter.  <a href="#a84c7eed4027ed8009c41013d329974dd">More...</a><br /></td></tr>
<tr class="separator:a84c7eed4027ed8009c41013d329974dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29a281630b657b2c822899d1bfce1758"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a29a281630b657b2c822899d1bfce1758">TimeConvert_Difference_TTtoTDB</a> (double tt_mjd) const</td></tr>
<tr class="memdesc:a29a281630b657b2c822899d1bfce1758"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the difference in seconds between a TT time and a TDB time. The input TT time is expected to be in Modified Julian Days!  <a href="#a29a281630b657b2c822899d1bfce1758">More...</a><br /></td></tr>
<tr class="separator:a29a281630b657b2c822899d1bfce1758"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5475f9c01707f9101128f415fb3aaf07"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a5475f9c01707f9101128f415fb3aaf07">TimeConvert_ctatv</a> (long JulianDayNumber, double FractionalJulianDay) const</td></tr>
<tr class="memdesc:a5475f9c01707f9101128f415fb3aaf07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the cumulative relativistic time correction to earth-based clocks, TDB-TDT, for a given time. Routine furnished by the Bureau des Longitudes, modified by removal of terms much smaller than 0.1 microsecond.  <a href="#a5475f9c01707f9101128f415fb3aaf07">More...</a><br /></td></tr>
<tr class="separator:a5475f9c01707f9101128f415fb3aaf07"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a640c21d2f80b7aff2cea1d9984df7ed6"><td class="memItemLeft" align="right" valign="top"><a id="a640c21d2f80b7aff2cea1d9984df7ed6"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a640c21d2f80b7aff2cea1d9984df7ed6">m_ra</a></td></tr>
<tr class="memdesc:a640c21d2f80b7aff2cea1d9984df7ed6"><td class="mdescLeft">&#160;</td><td class="mdescRight">the RA of the source <br /></td></tr>
<tr class="separator:a640c21d2f80b7aff2cea1d9984df7ed6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72758ee842a321426fdae9688ac1dbf"><td class="memItemLeft" align="right" valign="top"><a id="ad72758ee842a321426fdae9688ac1dbf"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#ad72758ee842a321426fdae9688ac1dbf">m_dec</a></td></tr>
<tr class="memdesc:ad72758ee842a321426fdae9688ac1dbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">the DEC of the source <br /></td></tr>
<tr class="separator:ad72758ee842a321426fdae9688ac1dbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab23d1b199d60df2cb89cef70ca3c5b3f"><td class="memItemLeft" align="right" valign="top"><a id="ab23d1b199d60df2cb89cef70ca3c5b3f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#ab23d1b199d60df2cb89cef70ca3c5b3f">m_sourceDirection</a> [3]</td></tr>
<tr class="memdesc:ab23d1b199d60df2cb89cef70ca3c5b3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">cartesian unit vector in the direction of the source <br /></td></tr>
<tr class="separator:ab23d1b199d60df2cb89cef70ca3c5b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf87ff27ffe7b344916a94b1db9a651"><td class="memItemLeft" align="right" valign="top"><a id="a2cf87ff27ffe7b344916a94b1db9a651"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a2cf87ff27ffe7b344916a94b1db9a651">m_initialized</a></td></tr>
<tr class="memdesc:a2cf87ff27ffe7b344916a94b1db9a651"><td class="mdescLeft">&#160;</td><td class="mdescRight">boolean to indicate whether or not the data members of the class have been initialized <br /></td></tr>
<tr class="separator:a2cf87ff27ffe7b344916a94b1db9a651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49a1bd0f3eaba522a4c60f8cb32e0128"><td class="memItemLeft" align="right" valign="top"><a id="a49a1bd0f3eaba522a4c60f8cb32e0128"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryTstart</b></td></tr>
<tr class="separator:a49a1bd0f3eaba522a4c60f8cb32e0128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc992138e4c0a2abd53b4f3f5d62ea11"><td class="memItemLeft" align="right" valign="top"><a id="acc992138e4c0a2abd53b4f3f5d62ea11"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryTstop</b></td></tr>
<tr class="separator:acc992138e4c0a2abd53b4f3f5d62ea11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107511c6669f464c2a070bc7655e093c"><td class="memItemLeft" align="right" valign="top"><a id="a107511c6669f464c2a070bc7655e093c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryTimedel</b></td></tr>
<tr class="separator:a107511c6669f464c2a070bc7655e093c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1000580072b34da569d05fedba1f6a4"><td class="memItemLeft" align="right" valign="top"><a id="af1000580072b34da569d05fedba1f6a4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryPoint</b> [3]</td></tr>
<tr class="separator:af1000580072b34da569d05fedba1f6a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c1a74c781c5bfb96f95491f5ade0230"><td class="memItemLeft" align="right" valign="top"><a id="a2c1a74c781c5bfb96f95491f5ade0230"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryCoeff</b> [3]</td></tr>
<tr class="separator:a2c1a74c781c5bfb96f95491f5ade0230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b53cb2eb8726d200c0269c7e6375ea5"><td class="memItemLeft" align="right" valign="top"><a id="a8b53cb2eb8726d200c0269c7e6375ea5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>m_barySubin</b> [3]</td></tr>
<tr class="separator:a8b53cb2eb8726d200c0269c7e6375ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bad96c268525178b31342798f2927db"><td class="memItemLeft" align="right" valign="top"><a id="a6bad96c268525178b31342798f2927db"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryEMratinv</b></td></tr>
<tr class="separator:a6bad96c268525178b31342798f2927db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f0de18481a48d8438ceb2a8406636c"><td class="memItemLeft" align="right" valign="top"><a id="a93f0de18481a48d8438ceb2a8406636c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryMsol</b></td></tr>
<tr class="separator:a93f0de18481a48d8438ceb2a8406636c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a339c759987b76bcc8ee526c8b39ab39f"><td class="memItemLeft" align="right" valign="top"><a id="a339c759987b76bcc8ee526c8b39ab39f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryRadSol</b></td></tr>
<tr class="separator:a339c759987b76bcc8ee526c8b39ab39f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3caf53ce52a568743b4b8f9ecd41c8f"><td class="memItemLeft" align="right" valign="top"><a id="ad3caf53ce52a568743b4b8f9ecd41c8f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryInvTdel</b></td></tr>
<tr class="separator:ad3caf53ce52a568743b4b8f9ecd41c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaec5d1a060beb4be021820da7aceb835"><td class="memItemLeft" align="right" valign="top"><a id="aaec5d1a060beb4be021820da7aceb835"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryAUfac</b></td></tr>
<tr class="separator:aaec5d1a060beb4be021820da7aceb835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23c49ae45a7094747cbf85d70b436a68"><td class="memItemLeft" align="right" valign="top"><a id="a23c49ae45a7094747cbf85d70b436a68"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryVELfac</b></td></tr>
<tr class="separator:a23c49ae45a7094747cbf85d70b436a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa6436eb9bc78ab8fd7c0814dbcc895"><td class="memItemLeft" align="right" valign="top"><a id="aaaa6436eb9bc78ab8fd7c0814dbcc895"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_baryBuffer</b></td></tr>
<tr class="separator:aaaa6436eb9bc78ab8fd7c0814dbcc895"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43fcb34a5c9a4c178789aa08a95774cb"><td class="memItemLeft" align="right" valign="top"><a id="a43fcb34a5c9a4c178789aa08a95774cb"></a>
long&#160;</td><td class="memItemRight" valign="bottom"><b>m_oldrow</b></td></tr>
<tr class="separator:a43fcb34a5c9a4c178789aa08a95774cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a2a66d15db583b8c1b5e4b44dcf3784cd"><td class="memItemLeft" align="right" valign="top"><a id="a2a66d15db583b8c1b5e4b44dcf3784cd"></a>
static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_barycentric_offset.html#a2a66d15db583b8c1b5e4b44dcf3784cd">m_ephemerisFilename</a></td></tr>
<tr class="memdesc:a2a66d15db583b8c1b5e4b44dcf3784cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">path to the ephemeris file <br /></td></tr>
<tr class="separator:a2a66d15db583b8c1b5e4b44dcf3784cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class to calculate the time difference of <a class="el" href="class_b_j_d.html" title="A class to store a Barycentric Julian Day (BJD) ">BJD</a> - <a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a>. </p>
<hr/>
 <dl class="section author"><dt>Author</dt><dd>David Futyan, UGE</dd></dl>
<p>An instance of this class can calculate the time offset between Barycentic Julian Day <a class="el" href="class_b_j_d.html" title="A class to store a Barycentric Julian Day (BJD) ">BJD</a> and Modified Julian Day <a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a> for a specific source in the sky, i.e. for a specific RA / DEC. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="_time_classes_8cxx-example.html#_a14">TimeClasses.cxx</a>.</dd>
</dl></div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2ece112267747a07f63693e6af49e97c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ece112267747a07f63693e6af49e97c">&#9670;&nbsp;</a></span>BarycentricOffset() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BarycentricOffset::BarycentricOffset </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The class is initialized for a specific source, i.e. with its sky position RA / DEC. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ra</td><td>Right Ascension of the source for which the offset shall be calculated. It has to be in the range [-180 .. 360[ The unit is deg. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dec</td><td>Declination of the source for which the offset shall be calculated. It has to be in the range [-90 .. 90] The unit is deg. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af7a0d7179b3d5e35475844edb854f07f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7a0d7179b3d5e35475844edb854f07f">&#9670;&nbsp;</a></span>BarycentricOffset() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BarycentricOffset::BarycentricOffset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_barycentric_offset.html">BarycentricOffset</a> &amp;&#160;</td>
          <td class="paramname"><em>barycentricOffset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy constructor of the <a class="el" href="class_barycentric_offset.html" title="A class to calculate the time difference of BJD - MJD. ">BarycentricOffset</a> class. </p>
<hr/>
 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a903f8e8dcc5b9990b5ce431c9733b29f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a903f8e8dcc5b9990b5ce431c9733b29f">&#9670;&nbsp;</a></span>calcVector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void BarycentricOffset::calcVector </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transforms a RA and Dec orientation in degrees into a unit vector in J2000 ECI coordinates. </p>
<hr/>
 
</div>
</div>
<a id="a00a9bb8d30418b612da0ed1acae6a20c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00a9bb8d30418b612da0ed1acae6a20c">&#9670;&nbsp;</a></span>getBaryVectors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void BarycentricOffset::getBaryVectors </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt_ijd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SolSysBaryCenter_to_Spacecraft</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Sun_to_Spacecraft</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>EarthVelocity</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the various vectors needed for the barycentric correction at the given input time, which is expected to be IJD. </p>
<hr/>
 
</div>
</div>
<a id="a259da5dd022565a9f0f84e89f47d501f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a259da5dd022565a9f0f84e89f47d501f">&#9670;&nbsp;</a></span>getDE200()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void BarycentricOffset::getDE200 </td>
          <td>(</td>
          <td class="paramtype">BODY&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ttime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pos</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vel</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function reads the ISDC DE200 ephemeris. Bodies are restricted to Earth-Moon barycenter (SSB), Moon (Geocentric) and Sun (SSB). Returns position and velocities in 3-vectors if pointer!=NULL. </p>
<hr/>
 
</div>
</div>
<a id="a7294888de9431ae01986afd76815a15e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7294888de9431ae01986afd76815a15e">&#9670;&nbsp;</a></span>initBarycent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void BarycentricOffset::initBarycent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read physical constants from the ephemiris file and initialize some variables. </p>
<hr/>
 
</div>
</div>
<a id="adcf77584a92a19de51975a5be479b997"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcf77584a92a19de51975a5be479b997">&#9670;&nbsp;</a></span>Offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double BarycentricOffset::Offset </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method to calculate the time offset between <a class="el" href="class_b_j_d.html" title="A class to store a Barycentric Julian Day (BJD) ">BJD</a> and <a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a>. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mjd</td><td><a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a> for which the time offset shall be calculated</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the offset between <a class="el" href="class_b_j_d.html" title="A class to store a Barycentric Julian Day (BJD) ">BJD</a> and <a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a> ( = <a class="el" href="class_b_j_d.html" title="A class to store a Barycentric Julian Day (BJD) ">BJD</a> - <a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a>) in days </dd></dl>

</div>
</div>
<a id="ae5670eafc5031a09af5ddc893d29d4ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5670eafc5031a09af5ddc893d29d4ff">&#9670;&nbsp;</a></span>setEphemerisFileName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void BarycentricOffset::setEphemerisFileName </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defines the file containing the ephemeris data in a EXT_APP_DE1 data structure. It is called by the <a class="el" href="group___prog_param.html#gac588050f01e813c2a25336cb967f20b5" title="Initializes various infrastructure modules using the program arguments. ">CheopsInit()</a> function. </p>
<hr/>
 
</div>
</div>
<a id="a84c7eed4027ed8009c41013d329974dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84c7eed4027ed8009c41013d329974dd">&#9670;&nbsp;</a></span>TimeConvert_BaryCenter_Correction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double BarycentricOffset::TimeConvert_BaryCenter_Correction </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt_mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SolSysBaryCenter_to_Spacecraft</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Sun_to_Spacecraft</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>EarthVelocity</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SolarMass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the shift in seconds between an observed time in <a class="el" href="class_m_j_d.html" title="A class to store a Modified Julian Day (MJD) ">MJD</a> and the time of measurement at the solar system barycenter. </p>
<hr/>
<p> The correction from a measured time to solar system barycenter can be generally expressed as follows:</p>
<p>barycentered_time = observed_time</p><ul>
<li>clock corrections [done before]</li>
<li>dispersion [0 for X-rays]</li>
<li>geometric light travel time [up to ~500s]</li>
<li>"Einstein corrections" [millisec]</li>
<li>"Shapiro delay" [microsec]</li>
</ul>
<p>We assume here that all corrections from the spacecraft clock to geocentric terrestrial time have already been done. The dispersion corrections are zero for X-rays. [See also <a href="http://lheawww.gsfc.nasa.gov/users/craigm/bary/">http://lheawww.gsfc.nasa.gov/users/craigm/bary/</a>]</p>
<p>All corrections below are expressed in <em>seconds</em>. </p>

</div>
</div>
<a id="a5475f9c01707f9101128f415fb3aaf07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5475f9c01707f9101128f415fb3aaf07">&#9670;&nbsp;</a></span>TimeConvert_ctatv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double BarycentricOffset::TimeConvert_ctatv </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>JulianDayNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>FractionalJulianDay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the cumulative relativistic time correction to earth-based clocks, TDB-TDT, for a given time. Routine furnished by the Bureau des Longitudes, modified by removal of terms much smaller than 0.1 microsecond. </p>
<hr/>
<p> Method: Convert input time to millennia since 2000.0 For each sinusoidal term of sufficient amplitude Compute value of term at input time End for Add together all terms and convert from microseconds to seconds</p>
<p>Results of this routine has been confirmed up to (1E-10)microsecond level compared with the calculation by the IBM machine: this seems to be within the 64-bit precision allowance, but still the original hardcopy should be kept as the right one. (M.M.)</p>
<p>Note for the C version: the accuracy is guaranteed to 100 ns. </p>

</div>
</div>
<a id="a29a281630b657b2c822899d1bfce1758"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29a281630b657b2c822899d1bfce1758">&#9670;&nbsp;</a></span>TimeConvert_Difference_TTtoTDB()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double BarycentricOffset::TimeConvert_Difference_TTtoTDB </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tt_mjd</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the difference in seconds between a TT time and a TDB time. The input TT time is expected to be in Modified Julian Days! </p>
<hr/>
<p> The order of magnitude for these corrections is typically ms and the drift of corrections within a single day is of order 10^-5 s.</p>
<p>It uses the coefficients from Fairhead &amp; Bretagnon 1990, A&amp;A 229, 240, as provided by TimeConvert_ctatv. The accuracy is better than 100 ns.</p>
<p>The proper way to do all this is to abandon TDB and use TCB.</p>
<p>The way this is done is as follows: TDB-TT and its derivative are calculated for the integer part of the Julian Day (when needed). The precise value is derived from the fractional part and derivative. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>utilities/include/<a class="el" href="_barycentric_offset_8hxx_source.html">BarycentricOffset.hxx</a></li>
<li>utilities/src/<a class="el" href="_barycentric_offset_8cxx.html">BarycentricOffset.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 11 2021 08:55:55 for Common Software by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
