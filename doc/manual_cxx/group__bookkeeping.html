<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Common Software: Bookkeeping</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cheops-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Common Software
   &#160;<span id="projectnumber">05</span>
   </div>
   <div id="projectbrief">Common Software for CHEOPS SOC - C++ API</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a>  </div>
  <div class="headertitle">
<div class="title">Bookkeeping</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module provides a class to book the status of the progress of the processing of observation requests.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:_bookkeeping_8hxx"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bookkeeping_8hxx.html">Bookkeeping.hxx</a></td></tr>
<tr class="memdesc:_bookkeeping_8hxx"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declaration of the <a class="el" href="class_bookkeeping.html" title="Main class of the Bookkeeping module. ">Bookkeeping</a> class, the <a class="el" href="struct_b_k_number.html" title="Defines one number of a bookkeeping item. ">BKNumber</a> struct and the <a class="el" href="struct_b_k_item.html" title="Defines one item for which the status is / can be booked. ">BKItem</a> struct. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:_bookkeeping_8cxx"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bookkeeping_8cxx.html">Bookkeeping.cxx</a></td></tr>
<tr class="memdesc:_bookkeeping_8cxx"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of the <a class="el" href="class_bookkeeping.html" title="Main class of the Bookkeeping module. ">Bookkeeping</a> class. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_b_k_number.html">BKNumber</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines one number of a bookkeeping item.  <a href="struct_b_k_number.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_b_k_item.html">BKItem</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines one item for which the status is / can be booked.  <a href="struct_b_k_item.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bookkeeping.html">Bookkeeping</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main class of the <a class="el" href="class_bookkeeping.html" title="Main class of the Bookkeeping module. ">Bookkeeping</a> module.  <a href="class_bookkeeping.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga39b9419747613582b9a1280bbc369bd3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bookkeeping.html#ga39b9419747613582b9a1280bbc369bd3">BK_DATA_TYPE</a> { <a class="el" href="group__bookkeeping.html#gga39b9419747613582b9a1280bbc369bd3a4e3ebf8a65877b3fd7f99d6dd7ff2020">bk_uint8</a>, 
<a class="el" href="group__bookkeeping.html#gga39b9419747613582b9a1280bbc369bd3a3c223c76513a980c39595d1027198f41">bk_uint16</a>, 
<a class="el" href="group__bookkeeping.html#gga39b9419747613582b9a1280bbc369bd3a6c56b4c0d3be99daa7273cd812050ca8">bk_UTC</a>, 
<a class="el" href="group__bookkeeping.html#gga39b9419747613582b9a1280bbc369bd3ab00ccaf462e1b3697d73e26418754dcb">bk_uint32</a>
 }</td></tr>
<tr class="memdesc:ga39b9419747613582b9a1280bbc369bd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the possible data types a number of a bookkeeping item can have.  <a href="group__bookkeeping.html#ga39b9419747613582b9a1280bbc369bd3">More...</a><br /></td></tr>
<tr class="separator:ga39b9419747613582b9a1280bbc369bd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This module provides a class to book the status of the progress of the processing of observation requests. </p>
<hr/>
<dl class="section author"><dt>Author</dt><dd>Reiner Rohlfs UGE</dd></dl>
<h3>Use Cases </h3>
<p>Currently 2 use cases of this bookkeeping module are envisaged:</p>
<ol type="1">
<li><b>To assign the next visit counter to a visit of a given observation request.</b><br />
 A visit counter shall be assigned by Prerocessing to the data of a visit. The counter shall be increased for each new visit of an observation request and the same counter shall not be assigned to two different visits of the same observation request.<br />
 Following has to be considered:<ul>
<li>There are three programs which may first process the data of a new visit: hk_conversion, science_conversion and event_conversion.</li>
<li>The same visit counter should be assigned to re-processed data as it was done for the first processing of the visit data.</li>
</ul>
</li>
<li><p class="startli"><b>To keep track for which visits the Data Reduction chain has already been kicked off.</b><br />
 Once all data of a visit are available at SOC the Data Reduction chain shall be kicked-off.<br />
 Following has to be considered:</p><ul>
<li>There are three programs which may process the last data of a visit: pass_combination, obtutc_conversoin and orbit_conversion for restituted orbit data.</li>
<li>The Visit Timeout shall kick-off the Data Reduction chain if after a timeout not all data of a visit have arrived at SOC. Therefore this program has to "know" which visits are not yet processed by Data Reduction.</li>
<li>The Data Reduction chain shall not be kicked off twice for the same visit, except for re-processing. <br />
 <h3>Design </h3>
</li>
</ul>
<ul>
<li>Independent groups of bookkeeping can be handled. Each group is for example one of the use cases, described above.</li>
<li>A bookkeeping group keeps track of the bookkeeping items. In the use cases described above each visit is a bookkeeping item.</li>
<li>The status of an item is either available or not available. Once an item is created it will not be updated any more. <br />
 - A bookkeeping item is defined by several numbers. Each number has a name. The bookkeeping group defines the names of the numbers that belong the the group. Therefore all items of the same bookkeeping group have values for the same numbers. For the use cases above following numbers are defined:<ol type="a">
<li><b>Visit Counter</b><br />
<ul>
<li>Start time of the visit</li>
<li>End time of the visit</li>
<li>Programme Type</li>
<li>Programme Id</li>
<li>Observation Request Id</li>
<li>Visit Counter</li>
</ul>
</li>
<li><b>Visits processed by Data Reduction chain</b><br />
<ul>
<li>Start time of the visit</li>
<li>End time of the visit</li>
<li>Programme Type</li>
<li>Programme Id</li>
<li>Observation Request Id</li>
<li>Visit Counter</li>
<li>Archive revision number (ARCH_REV)</li>
<li>Processing Number (PROC_NUM) <br />
 - Each bookkeeping item is implemented as a file. There is no content of the file. All the values of the item are defined in the filename.<br />
 The files with their correct filename will be created with a mv command. They exist or do not exist for other programs which may read the status of the bookkeeping in parallel, i.e. the status of the item is either existing or not existing.</li>
</ul>
</li>
</ol>
</li>
<li>All files of a bookkeeping group are located in the same directory. Such a directory of bookkeeping items build the bookkeeping group.</li>
</ul>
<p class="startli">Note: Assuming two programs are looking "at the same time" for a new visit counter for new data of a visit. They may both find the status that this visit is new and will create a new item-file for the new visit. As long as both programs implement the same decision to define the next visit counter and create a new bookkeeping item the visit counter is correct. The same item-file will be created twice, but the second will just overwrite the first instance. <br />
 </p><h3>Implementation </h3>
</li>
</ol>
<ul>
<li>Except for the start and end of a visit the item-numbers are implemented by the <a class="el" href="struct_b_k_number.html" title="Defines one number of a bookkeeping item. ">BKNumber</a> struct. Two different data types of a number are currently implemented. A bookkeeping number can be a key-number. This is used by the <a class="el" href="class_bookkeeping.html#a570c5c53b596b326286acc2995c49813" title="Returns a list of BKItems that currently exist and have the same values as bkItem for the key - numbe...">Bookkeeping::Find()</a> methods.</li>
<li>A bookkeeping item is implemented by the <a class="el" href="struct_b_k_item.html" title="Defines one item for which the status is / can be booked. ">BKItem</a> struct. It stores the start and end time of the item, i.e. of the visit, and a vector of <a class="el" href="struct_b_k_number.html" title="Defines one number of a bookkeeping item. ">BKNumber</a>. <br />
</li>
<li>A bookkeeping group is implemented by the <a class="el" href="class_bookkeeping.html" title="Main class of the Bookkeeping module. ">Bookkeeping</a> class. The constructor of this class expects a vector of <a class="el" href="struct_b_k_number.html" title="Defines one number of a bookkeeping item. ">BKNumber</a>. This list defines the names of the numbers of all items of the bookkeeping group when the bookkeeping group is instantiated for the very first time, i.e. when the group is created. If the group exist already, i. e. the group directory exist already, the constructor verifies the item names.<br />
 Note: the vector of item numbers is stored as filename of a specific file in the directory of the bookkeeping group. </li>
</ul>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga39b9419747613582b9a1280bbc369bd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga39b9419747613582b9a1280bbc369bd3">&#9670;&nbsp;</a></span>BK_DATA_TYPE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__bookkeeping.html#ga39b9419747613582b9a1280bbc369bd3">BK_DATA_TYPE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the possible data types a number of a bookkeeping item can have. </p>
<hr/>
<dl class="section author"><dt>Author</dt><dd>Reiner Rohlfs UGE </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga39b9419747613582b9a1280bbc369bd3a4e3ebf8a65877b3fd7f99d6dd7ff2020"></a>bk_uint8&#160;</td><td class="fielddoc"><p>unsigned integer 1 byte </p>
</td></tr>
<tr><td class="fieldname"><a id="gga39b9419747613582b9a1280bbc369bd3a3c223c76513a980c39595d1027198f41"></a>bk_uint16&#160;</td><td class="fielddoc"><p>unsigned integer 2 bytes </p>
</td></tr>
<tr><td class="fieldname"><a id="gga39b9419747613582b9a1280bbc369bd3a6c56b4c0d3be99daa7273cd812050ca8"></a>bk_UTC&#160;</td><td class="fielddoc"><p>a <a class="el" href="class_u_t_c.html" title="To store a UTC time. ">UTC</a> time </p>
</td></tr>
<tr><td class="fieldname"><a id="gga39b9419747613582b9a1280bbc369bd3ab00ccaf462e1b3697d73e26418754dcb"></a>bk_uint32&#160;</td><td class="fielddoc"><p>unsigned integer 4 bytes </p>
</td></tr>
</table>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 11 2021 08:55:55 for Common Software by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
